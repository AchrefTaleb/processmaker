/**
 * StartEventShape
 */
export class EventShape{
    constructor(canvas, svgLoader) {
        this.canvas = canvas;
        this.shape = this.canvas.group();
        this.svgLoader = svgLoader;
        this.x = 100;
        this.y = 100;
        this.scale = 40;
        this.attr = {
            fill: '#B4DCCB',
            stroke: '#018A4F',
            strokeWidth: 2
        };
        this.animateOptions = {r: this.scale};
        this.animationTime = 10;
        this.inputConnectors = new Map();
        this.outputConnectors = new Map();
    }

    config(options) {
        this.x = +options.x - 4;
        this.y = +options.y - 4;
        this.scale = options.width || this.scale;
        this.options = options;
        this.attr = options.attr || this.attr;
        this.attr.id = options.id;
        this.animateOptions.r = +options.width / 2 || this.scale;
        this.animateOptions = options.animateOptions || this.animateOptions;
        this.animationTime = options.animationTime || this.animationTime;
    }

    getBase(type, marker) {
        const x = this.x + this.x * 0.043;
        const y = this.y + this.y * 0.043;
        const bases = {
            'bpmn:StartEvent': {
                'EMPTY': {path: 'm496 48c-176 0-345 113-412 276-70 161-34 362 89 487 119 128 314 175 477 115 169-58 294-224 301-403 12-176-92-351-250-428-62-31-132-47-201-47-1 0-3 0-4 0z m12 49c173 1 335 126 380 293 47 159-17 344-155 439-143 105-354 97-489-18-136-109-185-309-115-468 60-147 212-248 371-246 3 0 6 0 8 0z',
                    options: {x: x, y: y, scale: 's0.04', attr: {
                    stroke: '#000',
                    strokeWidth: 0,
                    //id: this.options.id
                }}},
                'bpmn:MessageEventDefinition': {path: 'm500 48c-178-2-349 112-416 276-70 161-34 362 89 487 119 128 314 175 477 115 169-58 294-224 301-403 12-176-92-351-250-428-62-31-132-47-201-47z m0 49c175-3 342 123 388 293 47 159-17 344-155 439-143 105-354 97-489-18-136-109-185-309-115-468 60-147 212-248 371-246z m-205 247c0 104 0 208 0 312 137 0 273 0 410 0 0-104 0-208 0-312-137 0-273 0-410 0z m91 49c76 0 152 0 228 0-40 24-81 79-121 85-36-29-71-57-107-85z m270 28c0 62 0 124 0 186-104 0-208 0-312 0 0-62 0-124 0-186 52 42 104 83 156 125 52-42 104-83 156-125z',
                    options: {x: x, y: y, scale: 's0.04', attr: {
                    stroke: '#000',
                    strokeWidth: 0
                }}},
                'SIGNALCATCH': {path: 'm500 48c-178-2-349 112-416 276-70 161-34 362 89 487 119 128 314 175 477 115 169-58 294-224 301-403 12-176-92-351-250-428-62-31-132-47-201-47z m0 49c175-3 342 123 388 293 47 159-17 344-155 439-143 105-354 97-489-18-136-109-185-309-115-468 60-147 212-248 371-246z m0 191c-64 115-128 230-192 345 128 0 256 0 384 0-64-115-128-230-192-345z m0 51c50 90 100 180 151 270-101 0-201 0-302 0 51-90 101-180 151-270z',
                    options: {x: x, y: y, scale: 's0.04', attr: {
                    stroke: '#000',
                    strokeWidth: 0
                }}},
                'CONDITIONAL': {path: 'm500 48c-249 0-452 203-452 452 0 249 203 452 452 452 249 0 452-203 452-452 0-249-203-452-452-452z m0 49c223 0 403 180 403 403 0 223-180 403-403 403-223 0-403-180-403-403 0-223 180-403 403-403z m-151 213l0 12 0 368 50 0 202 0 50 0 0-380-302 0z m24 24l254 0 0 332-26 0-202 0-26 0 0-332z m26 37l0 25 202 0 0-25-202 0z m0 74l0 24 202 0 0-24-202 0z m0 85l0 24 202 0 0-24-202 0z m0 77l0 24 202 0 0-24-202 0z',
                    options: {x: x, y: y, scale: 's0.04', attr: {
                    stroke: '#000',
                    strokeWidth: 0
                }}},
                'TIMER': {path: 'm500 48c-249 0-452 203-452 452 0 249 203 452 452 452 249 0 452-203 452-452 0-249-203-452-452-452z m0 49c223 0 403 180 403 403 0 223-180 403-403 403-223 0-403-180-403-403 0-223 180-403 403-403z m-4 189c-84 0-164 55-194 133-33 76-15 170 43 229 56 60 149 82 226 54 81-28 141-108 143-194 5-83-46-166-121-201-29-14-61-21-93-21-1 0-3 0-4 0z m8 39c76 0 148 57 166 131 20 73-14 156-79 194-67 42-160 31-215-26-58-56-68-152-24-219 32-49 89-81 148-80 1 0 2 0 4 0z m51 49c-19 36-39 71-58 107-18 2-23 29-6 36 11 8 20-5 30-4l89 0 0-25-89 0c18-34 37-68 56-102-7-4-14-8-22-12z',
                    options: {x: x, y: y, scale: 's0.04', attr: {
                    stroke: '#000',
                    strokeWidth: 0
                }}}
            },
            'bpmn:EndEvent': {
                'EMPTY': {path: 'm496 48c-203-1-394 153-437 351-41 174 33 368 181 470 143 103 348 111 497 15 150-91 238-275 210-449-26-181-170-339-350-376-33-7-67-11-101-11z m10 142c150-1 287 123 302 271 19 142-72 291-210 334-134 45-296-13-366-138-77-129-45-313 78-403 56-43 126-66 196-64z',
                    options: {x: x, y: y, scale: 's0.04', attr: {
                    stroke: '#000',
                    strokeWidth: 0,
                    //id: this.options.id
                }}},
                'EMAIL': {path: 'm491 48c-219 0-420 183-440 400-22 186 82 380 253 459 158 77 361 53 492-67 134-115 192-312 133-480-55-172-220-303-401-311-13-1-25-1-37-1z m9 142c161-5 308 137 310 298 7 147-103 292-250 317-142 28-300-54-350-192-53-136 2-309 132-380 47-28 103-43 158-43z m-167 154c57 46 114 92 171 138 56-46 113-92 170-138-114 0-227 0-341 0z m-38 32c0 93 0 187 0 280 137 0 273 0 410 0 0-91 0-183 0-274-67 54-134 109-201 163-70-56-139-113-209-169z',
                    options: {x: x, y: y, scale: 's0.04', attr: {
                    stroke: '#000',
                    strokeWidth: 0
                }}},
                'MESSAGETHROW': {path: 'm491 48c-219 0-420 183-440 400-22 186 82 380 253 459 158 77 361 53 492-67 134-115 192-312 133-480-55-172-220-303-401-311-13-1-25-1-37-1z m9 142c161-5 308 137 310 298 7 147-103 292-250 317-142 28-300-54-350-192-53-136 2-309 132-380 47-28 103-43 158-43z m-167 154c57 46 114 92 171 138 56-46 113-92 170-138-114 0-227 0-341 0z m-38 32c0 93 0 187 0 280 137 0 273 0 410 0 0-91 0-183 0-274-67 54-134 109-201 163-70-56-139-113-209-169z',
                    options: {x: x, y: y, scale: 's0.04', attr: {
                    stroke: '#000',
                    strokeWidth: 0
                }}},
                'ERRORTHROW': {path: 'm491 48c-219 0-420 183-440 400-22 186 82 380 253 459 158 77 361 53 492-67 134-115 192-312 133-480-55-172-220-303-401-311-13-1-25-1-37-1z m9 142c161-5 308 137 310 298 7 147-103 292-250 317-142 28-300-54-350-192-53-136 2-309 132-380 47-28 103-43 158-43z m173 117c-34 70-68 139-102 209-43-56-86-111-128-166-39 114-77 228-116 342 43-55 87-111 130-167 45 51 89 103 134 154 27-124 55-248 82-372z', options: {x: x, y: y, scale: 's0.04', attr: {
                    stroke: '#000',
                    strokeWidth: 0
                }}},
                'bpmn:TerminateEventDefinition': {path: 'm491 48c-219 0-420 183-440 400-22 186 82 380 253 459 158 77 361 53 492-67 134-115 192-312 133-480-55-172-220-303-401-311-13-1-25-1-37-1z m9 142c161-5 308 137 310 298 7 147-103 292-250 317-142 28-300-54-350-192-53-136 2-309 132-380 47-28 103-43 158-43z m0 81c-149-6-268 156-219 297 38 143 229 210 349 121 126-79 133-281 13-369-40-32-92-50-143-49z', options: {x: x, y: y, scale: 's0.04', attr: {
                    stroke: '#000',
                    strokeWidth: 0
                }}},
                'SIGNALTHROW': {path: 'm491 48c-219 0-420 183-440 400-22 186 82 380 253 459 158 77 361 53 492-67 134-115 192-312 133-480-55-172-220-303-401-311-13-1-25-1-37-1z m9 142c161-5 308 137 310 298 7 147-103 292-250 317-142 28-300-54-350-192-53-136 2-309 132-380 47-28 103-43 158-43z m0 98c-64 115-128 230-192 345 128 0 256 0 384 0-64-115-128-230-192-345z', options: {x: x, y: y, scale: 's0.04', attr: {
                    stroke: '#000',
                    strokeWidth: 0
                }}}
            },
            'bpmn:IntermediateThrowEvent': {
                'bpmn:MessageEventDefinition': {path: 'm499 48c-220-4-425 177-448 396-24 185 78 380 247 461 160 80 368 56 501-66 134-118 190-318 128-486-57-167-217-293-393-303-12-1-23-2-35-2z m-5 49c202-7 391 161 407 362 19 178-92 361-262 420-166 61-368 2-468-145-103-144-99-356 18-490 74-90 188-146 305-147z m8 44c-186-6-358 158-361 344-9 169 116 334 283 367 155 33 328-46 397-190 71-140 39-327-83-430-64-57-150-91-236-91z m-2 48c164-4 314 144 311 308 3 152-119 297-272 312-143 19-295-73-336-213-43-134 14-295 138-364 48-28 103-43 159-43z m-167 155c57 46 114 92 171 138 56-46 113-92 170-138-114 0-227 0-341 0z m-38 32c0 93 0 187 0 280 137 0 273 0 410 0 0-91 0-183 0-274-67 54-134 109-201 163-70-56-139-113-209-169z', options: {
                    x: x, y: y, scale: 's0.04', attr: {
                    stroke: '#000',
                    strokeWidth: 0
                }}},
                'EMAIL': {path: 'm499 48c-220-4-425 177-448 396-24 185 78 380 247 461 160 80 368 56 501-66 134-118 190-318 128-486-57-167-217-293-393-303-12-1-23-2-35-2z m-5 49c202-7 391 161 407 362 19 178-92 361-262 420-166 61-368 2-468-145-103-144-99-356 18-490 74-90 188-146 305-147z m8 44c-186-6-358 158-361 344-9 169 116 334 283 367 155 33 328-46 397-190 71-140 39-327-83-430-64-57-150-91-236-91z m-2 48c164-4 314 144 311 308 3 152-119 297-272 312-143 19-295-73-336-213-43-134 14-295 138-364 48-28 103-43 159-43z m-167 155c57 46 114 92 171 138 56-46 113-92 170-138-114 0-227 0-341 0z m-38 32c0 93 0 187 0 280 137 0 273 0 410 0 0-91 0-183 0-274-67 54-134 109-201 163-70-56-139-113-209-169z', options: {x: x, y: y, scale: 's0.04', attr: {
                    stroke: '#000',
                    strokeWidth: 0
                }}},
                'TIMER': {path: 'm499 48c-1 0-2 0-3 0-202-1-391 150-436 346-42 173 28 368 174 471 145 107 354 116 506 18 149-93 235-276 207-450-26-176-164-330-338-371-36-9-73-14-110-14z m-5 49c3 0 7 0 10 0 187-2 362 146 392 331 32 167-54 348-205 427-154 85-363 54-483-77-124-127-147-338-53-488 71-116 203-192 339-193z m8 44c-3 0-7 0-10 0-172 0-330 143-349 314-22 161 79 328 233 382 145 55 322 3 413-124 98-129 92-326-17-447-67-77-167-125-270-125z m-2 48c2 0 4 0 6 0 153 0 292 129 304 281 16 145-84 293-225 330-137 40-296-27-361-154-69-129-33-305 86-392 54-42 122-65 190-65z m-4 97c-84 0-164 55-194 133-33 76-15 170 43 229 56 60 149 82 226 54 81-28 141-108 143-194 5-83-46-166-121-201-29-14-61-21-93-21-1 0-3 0-4 0z m8 39c76 0 148 57 166 131 20 73-14 156-79 194-67 42-160 31-215-26-58-56-68-152-24-219 32-49 89-81 148-80 1 0 2 0 4 0z m51 49c-19 36-39 71-58 107-18 2-23 29-6 36 11 8 20-5 30-4l89 0 0-25-89 0c18-34 37-68 56-102-7-4-14-8-22-12z', options: {x: x, y: y, scale: 's0.04', attr: {
                    stroke: '#000',
                    strokeWidth: 0
                }}},
                'SIGNALCATCH': {path: 'm499 48c-220-4-425 177-448 396-24 185 78 380 247 461 160 80 368 56 501-66 134-118 190-318 128-486-57-167-217-293-393-303-12-1-23-2-35-2z m-5 49c202-7 391 161 407 362 19 178-92 361-262 420-166 61-368 2-468-145-103-144-99-356 18-490 74-90 188-146 305-147z m8 44c-186-6-358 158-361 344-9 169 116 334 283 367 155 33 328-46 397-190 71-140 39-327-83-430-64-57-150-91-236-91z m-2 48c164-4 314 144 311 308 3 152-119 297-272 312-143 19-295-73-336-213-43-134 14-295 138-364 48-28 103-43 159-43z m0 99c-64 115-128 230-192 345 128 0 256 0 384 0-64-115-128-230-192-345z m0 51c50 90 100 180 151 270-101 0-201 0-302 0 51-90 101-180 151-270z', options: {x: x, y: y, scale: 's0.04', attr: {
                    stroke: '#000',
                    strokeWidth: 0
                }}},
                'MESSAGECATCH': {path: 'm499 48c-220-4-425 177-448 396-24 185 78 380 247 461 160 80 368 56 501-66 134-118 190-318 128-486-57-167-217-293-393-303-12-1-23-2-35-2z m-5 49c202-7 391 161 407 362 19 178-92 361-262 420-166 61-368 2-468-145-103-144-99-356 18-490 74-90 188-146 305-147z m8 44c-186-6-358 158-361 344-9 169 116 334 283 367 155 33 328-46 397-190 71-140 39-327-83-430-64-57-150-91-236-91z m-2 48c164-4 314 144 311 308 3 152-119 297-272 312-143 19-295-73-336-213-43-134 14-295 138-364 48-28 103-43 159-43z m-205 155c0 104 0 208 0 312 137 0 273 0 410 0 0-104 0-208 0-312-137 0-273 0-410 0z m91 49c76 0 152 0 228 0-40 24-81 79-121 85-36-29-71-57-107-85z m270 28c0 62 0 124 0 186-104 0-208 0-312 0 0-62 0-124 0-186 52 42 104 83 156 125 52-42 104-83 156-125z', options: {
                    x: x, y: y, scale: 's0.04', attr: {
                    stroke: '#000',
                    strokeWidth: 0
                }}},
                'CONDITIONAL': {path: 'm499 48c-1 0-2 0-3 0-202-1-391 150-436 346-42 173 28 368 174 471 145 107 354 116 506 18 149-93 235-276 207-450-26-176-164-330-338-371-36-9-73-14-110-14z m-5 49c3 0 7 0 10 0 187-2 362 146 392 331 32 167-54 348-205 427-154 85-363 54-483-77-124-127-147-338-53-488 71-116 203-192 339-193z m8 44c-3 0-7 0-10 0-172 0-330 143-349 314-22 161 79 328 233 382 145 55 322 3 413-124 98-129 92-326-17-447-67-77-167-125-270-125z m-2 48c2 0 4 0 6 0 153 0 292 129 304 281 16 145-84 293-225 330-137 40-296-27-361-154-69-129-33-305 86-392 54-42 122-65 190-65z m-151 121l0 12 0 368 50 0 202 0 50 0 0-380-302 0z m24 24l254 0 0 332-26 0-202 0-26 0 0-332z m26 37l0 25 202 0 0-25-202 0z m0 74l0 24 202 0 0-24-202 0z m0 85l0 24 202 0 0-24-202 0z m0 77l0 24 202 0 0-24-202 0z', options: {
                    x: x, y: y, scale: 's0.04', attr: {
                        stroke: '#000',
                        strokeWidth: 0
                    }}},
                'SIGNALTHROW': {path: 'm499 48c-220-4-425 177-448 396-24 185 78 380 247 461 160 80 368 56 501-66 134-118 190-318 128-486-57-167-217-293-393-303-12-1-23-2-35-2z m-5 49c202-7 391 161 407 362 19 178-92 361-262 420-166 61-368 2-468-145-103-144-99-356 18-490 74-90 188-146 305-147z m8 44c-186-6-358 158-361 344-9 169 116 334 283 367 155 33 328-46 397-190 71-140 39-327-83-430-64-57-150-91-236-91z m-2 48c164-4 314 144 311 308 3 152-119 297-272 312-143 19-295-73-336-213-43-134 14-295 138-364 48-28 103-43 159-43z m0 99c-64 115-128 230-192 345 128 0 256 0 384 0-64-115-128-230-192-345z', options: {x: x, y: y, scale: 's0.04', attr: {
                    stroke: '#000',
                    strokeWidth: 0
                }}}
            },
            'bpmn:IntermediateCatchEvent': {
                'EMPTY': {path: 'm499 48c-220-4-425 177-448 396-24 185 78 380 247 461 160 80 368 56 501-66 134-118 190-318 128-486-57-167-217-293-393-303-12-1-23-2-35-2z m-5 49c202-7 391 161 407 362 19 178-92 361-262 420-166 61-368 2-468-145-103-144-99-356 18-490 74-90 188-146 305-147z m8 44c-186-6-358 158-361 344-9 169 116 334 283 367 155 33 328-46 397-190 71-140 39-327-83-430-64-57-150-91-236-91z m-2 48c164-4 314 144 311 308 3 152-119 297-272 312-143 19-295-73-336-213-43-134 14-295 138-364 48-28 103-43 159-43z m-167 155c57 46 114 92 171 138 56-46 113-92 170-138-114 0-227 0-341 0z m-38 32c0 93 0 187 0 280 137 0 273 0 410 0 0-91 0-183 0-274-67 54-134 109-201 163-70-56-139-113-209-169z', options: {
                    x: x, y: y, scale: 's0.04', attr: {
                        stroke: '#000',
                        strokeWidth: 0
                    }}},
                'EMAIL': {path: 'm499 48c-220-4-425 177-448 396-24 185 78 380 247 461 160 80 368 56 501-66 134-118 190-318 128-486-57-167-217-293-393-303-12-1-23-2-35-2z m-5 49c202-7 391 161 407 362 19 178-92 361-262 420-166 61-368 2-468-145-103-144-99-356 18-490 74-90 188-146 305-147z m8 44c-186-6-358 158-361 344-9 169 116 334 283 367 155 33 328-46 397-190 71-140 39-327-83-430-64-57-150-91-236-91z m-2 48c164-4 314 144 311 308 3 152-119 297-272 312-143 19-295-73-336-213-43-134 14-295 138-364 48-28 103-43 159-43z m-167 155c57 46 114 92 171 138 56-46 113-92 170-138-114 0-227 0-341 0z m-38 32c0 93 0 187 0 280 137 0 273 0 410 0 0-91 0-183 0-274-67 54-134 109-201 163-70-56-139-113-209-169z', options: {x: x, y: y, scale: 's0.04', attr: {
                    stroke: '#000',
                    strokeWidth: 0
                }}},
                'bpmn:TimerEventDefinition': {path: 'm499 48c-1 0-2 0-3 0-202-1-391 150-436 346-42 173 28 368 174 471 145 107 354 116 506 18 149-93 235-276 207-450-26-176-164-330-338-371-36-9-73-14-110-14z m-5 49c3 0 7 0 10 0 187-2 362 146 392 331 32 167-54 348-205 427-154 85-363 54-483-77-124-127-147-338-53-488 71-116 203-192 339-193z m8 44c-3 0-7 0-10 0-172 0-330 143-349 314-22 161 79 328 233 382 145 55 322 3 413-124 98-129 92-326-17-447-67-77-167-125-270-125z m-2 48c2 0 4 0 6 0 153 0 292 129 304 281 16 145-84 293-225 330-137 40-296-27-361-154-69-129-33-305 86-392 54-42 122-65 190-65z m-4 97c-84 0-164 55-194 133-33 76-15 170 43 229 56 60 149 82 226 54 81-28 141-108 143-194 5-83-46-166-121-201-29-14-61-21-93-21-1 0-3 0-4 0z m8 39c76 0 148 57 166 131 20 73-14 156-79 194-67 42-160 31-215-26-58-56-68-152-24-219 32-49 89-81 148-80 1 0 2 0 4 0z m51 49c-19 36-39 71-58 107-18 2-23 29-6 36 11 8 20-5 30-4l89 0 0-25-89 0c18-34 37-68 56-102-7-4-14-8-22-12z', options: {x: x, y: y, scale: 's0.04', attr: {
                    stroke: '#000',
                    strokeWidth: 0
                }}},
                'SIGNALCATCH': {path: 'm499 48c-220-4-425 177-448 396-24 185 78 380 247 461 160 80 368 56 501-66 134-118 190-318 128-486-57-167-217-293-393-303-12-1-23-2-35-2z m-5 49c202-7 391 161 407 362 19 178-92 361-262 420-166 61-368 2-468-145-103-144-99-356 18-490 74-90 188-146 305-147z m8 44c-186-6-358 158-361 344-9 169 116 334 283 367 155 33 328-46 397-190 71-140 39-327-83-430-64-57-150-91-236-91z m-2 48c164-4 314 144 311 308 3 152-119 297-272 312-143 19-295-73-336-213-43-134 14-295 138-364 48-28 103-43 159-43z m0 99c-64 115-128 230-192 345 128 0 256 0 384 0-64-115-128-230-192-345z m0 51c50 90 100 180 151 270-101 0-201 0-302 0 51-90 101-180 151-270z', options: {x: x, y: y, scale: 's0.04', attr: {
                    stroke: '#000',
                    strokeWidth: 0
                }}},
                'bpmn:MessageEventDefinition': {path: 'm499 48c-220-4-425 177-448 396-24 185 78 380 247 461 160 80 368 56 501-66 134-118 190-318 128-486-57-167-217-293-393-303-12-1-23-2-35-2z m-5 49c202-7 391 161 407 362 19 178-92 361-262 420-166 61-368 2-468-145-103-144-99-356 18-490 74-90 188-146 305-147z m8 44c-186-6-358 158-361 344-9 169 116 334 283 367 155 33 328-46 397-190 71-140 39-327-83-430-64-57-150-91-236-91z m-2 48c164-4 314 144 311 308 3 152-119 297-272 312-143 19-295-73-336-213-43-134 14-295 138-364 48-28 103-43 159-43z m-205 155c0 104 0 208 0 312 137 0 273 0 410 0 0-104 0-208 0-312-137 0-273 0-410 0z m91 49c76 0 152 0 228 0-40 24-81 79-121 85-36-29-71-57-107-85z m270 28c0 62 0 124 0 186-104 0-208 0-312 0 0-62 0-124 0-186 52 42 104 83 156 125 52-42 104-83 156-125z', options: {
                    x: x, y: y, scale: 's0.04', attr: {
                        stroke: '#000',
                        strokeWidth: 0
                    }}},
                'CONDITIONAL': {path: 'm499 48c-1 0-2 0-3 0-202-1-391 150-436 346-42 173 28 368 174 471 145 107 354 116 506 18 149-93 235-276 207-450-26-176-164-330-338-371-36-9-73-14-110-14z m-5 49c3 0 7 0 10 0 187-2 362 146 392 331 32 167-54 348-205 427-154 85-363 54-483-77-124-127-147-338-53-488 71-116 203-192 339-193z m8 44c-3 0-7 0-10 0-172 0-330 143-349 314-22 161 79 328 233 382 145 55 322 3 413-124 98-129 92-326-17-447-67-77-167-125-270-125z m-2 48c2 0 4 0 6 0 153 0 292 129 304 281 16 145-84 293-225 330-137 40-296-27-361-154-69-129-33-305 86-392 54-42 122-65 190-65z m-151 121l0 12 0 368 50 0 202 0 50 0 0-380-302 0z m24 24l254 0 0 332-26 0-202 0-26 0 0-332z m26 37l0 25 202 0 0-25-202 0z m0 74l0 24 202 0 0-24-202 0z m0 85l0 24 202 0 0-24-202 0z m0 77l0 24 202 0 0-24-202 0z', options: {
                    x: x, y: y, scale: 's0.04', attr: {
                        stroke: '#000',
                        strokeWidth: 0
                    }}},
                'SIGNALTHROW': {path: 'm499 48c-220-4-425 177-448 396-24 185 78 380 247 461 160 80 368 56 501-66 134-118 190-318 128-486-57-167-217-293-393-303-12-1-23-2-35-2z m-5 49c202-7 391 161 407 362 19 178-92 361-262 420-166 61-368 2-468-145-103-144-99-356 18-490 74-90 188-146 305-147z m8 44c-186-6-358 158-361 344-9 169 116 334 283 367 155 33 328-46 397-190 71-140 39-327-83-430-64-57-150-91-236-91z m-2 48c164-4 314 144 311 308 3 152-119 297-272 312-143 19-295-73-336-213-43-134 14-295 138-364 48-28 103-43 159-43z m0 99c-64 115-128 230-192 345 128 0 256 0 384 0-64-115-128-230-192-345z', options: {x: x, y: y, scale: 's0.04', attr: {
                    stroke: '#000',
                    strokeWidth: 0
                }}}
            },
            'bpmn:BoundaryEvent': {
                'bpmn:MessageEventDefinition': {path: 'm499 48c-220-4-425 177-448 396-24 185 78 380 247 461 160 80 368 56 501-66 134-118 190-318 128-486-57-167-217-293-393-303-12-1-23-2-35-2z m-5 49c202-7 391 161 407 362 19 178-92 361-262 420-166 61-368 2-468-145-103-144-99-356 18-490 74-90 188-146 305-147z m8 44c-186-6-358 158-361 344-9 169 116 334 283 367 155 33 328-46 397-190 71-140 39-327-83-430-64-57-150-91-236-91z m-2 48c164-4 314 144 311 308 3 152-119 297-272 312-143 19-295-73-336-213-43-134 14-295 138-364 48-28 103-43 159-43z m-167 155c57 46 114 92 171 138 56-46 113-92 170-138-114 0-227 0-341 0z m-38 32c0 93 0 187 0 280 137 0 273 0 410 0 0-91 0-183 0-274-67 54-134 109-201 163-70-56-139-113-209-169z', options: {
                    x: x, y: y, scale: 's0.04', attr: {
                        stroke: '#000',
                        strokeWidth: 0
                    }}},
                'EMAIL': {path: 'm499 48c-220-4-425 177-448 396-24 185 78 380 247 461 160 80 368 56 501-66 134-118 190-318 128-486-57-167-217-293-393-303-12-1-23-2-35-2z m-5 49c202-7 391 161 407 362 19 178-92 361-262 420-166 61-368 2-468-145-103-144-99-356 18-490 74-90 188-146 305-147z m8 44c-186-6-358 158-361 344-9 169 116 334 283 367 155 33 328-46 397-190 71-140 39-327-83-430-64-57-150-91-236-91z m-2 48c164-4 314 144 311 308 3 152-119 297-272 312-143 19-295-73-336-213-43-134 14-295 138-364 48-28 103-43 159-43z m-167 155c57 46 114 92 171 138 56-46 113-92 170-138-114 0-227 0-341 0z m-38 32c0 93 0 187 0 280 137 0 273 0 410 0 0-91 0-183 0-274-67 54-134 109-201 163-70-56-139-113-209-169z', options: {x: x, y: y, scale: 's0.04', attr: {
                    stroke: '#000',
                    strokeWidth: 0
                }}},
                'bpmn:TimerEventDefinition': {path: 'm499 48c-1 0-2 0-3 0-202-1-391 150-436 346-42 173 28 368 174 471 145 107 354 116 506 18 149-93 235-276 207-450-26-176-164-330-338-371-36-9-73-14-110-14z m-5 49c3 0 7 0 10 0 187-2 362 146 392 331 32 167-54 348-205 427-154 85-363 54-483-77-124-127-147-338-53-488 71-116 203-192 339-193z m8 44c-3 0-7 0-10 0-172 0-330 143-349 314-22 161 79 328 233 382 145 55 322 3 413-124 98-129 92-326-17-447-67-77-167-125-270-125z m-2 48c2 0 4 0 6 0 153 0 292 129 304 281 16 145-84 293-225 330-137 40-296-27-361-154-69-129-33-305 86-392 54-42 122-65 190-65z m-4 97c-84 0-164 55-194 133-33 76-15 170 43 229 56 60 149 82 226 54 81-28 141-108 143-194 5-83-46-166-121-201-29-14-61-21-93-21-1 0-3 0-4 0z m8 39c76 0 148 57 166 131 20 73-14 156-79 194-67 42-160 31-215-26-58-56-68-152-24-219 32-49 89-81 148-80 1 0 2 0 4 0z m51 49c-19 36-39 71-58 107-18 2-23 29-6 36 11 8 20-5 30-4l89 0 0-25-89 0c18-34 37-68 56-102-7-4-14-8-22-12z', options: {x: x, y: y, scale: 's0.04', attr: {
                    stroke: '#000',
                    strokeWidth: 0
                }}},
                'SIGNALCATCH': {path: 'm499 48c-220-4-425 177-448 396-24 185 78 380 247 461 160 80 368 56 501-66 134-118 190-318 128-486-57-167-217-293-393-303-12-1-23-2-35-2z m-5 49c202-7 391 161 407 362 19 178-92 361-262 420-166 61-368 2-468-145-103-144-99-356 18-490 74-90 188-146 305-147z m8 44c-186-6-358 158-361 344-9 169 116 334 283 367 155 33 328-46 397-190 71-140 39-327-83-430-64-57-150-91-236-91z m-2 48c164-4 314 144 311 308 3 152-119 297-272 312-143 19-295-73-336-213-43-134 14-295 138-364 48-28 103-43 159-43z m0 99c-64 115-128 230-192 345 128 0 256 0 384 0-64-115-128-230-192-345z m0 51c50 90 100 180 151 270-101 0-201 0-302 0 51-90 101-180 151-270z', options: {x: x, y: y, scale: 's0.04', attr: {
                    stroke: '#000',
                    strokeWidth: 0
                }}},
                'MESSAGECATCH': {path: 'm499 48c-220-4-425 177-448 396-24 185 78 380 247 461 160 80 368 56 501-66 134-118 190-318 128-486-57-167-217-293-393-303-12-1-23-2-35-2z m-5 49c202-7 391 161 407 362 19 178-92 361-262 420-166 61-368 2-468-145-103-144-99-356 18-490 74-90 188-146 305-147z m8 44c-186-6-358 158-361 344-9 169 116 334 283 367 155 33 328-46 397-190 71-140 39-327-83-430-64-57-150-91-236-91z m-2 48c164-4 314 144 311 308 3 152-119 297-272 312-143 19-295-73-336-213-43-134 14-295 138-364 48-28 103-43 159-43z m-205 155c0 104 0 208 0 312 137 0 273 0 410 0 0-104 0-208 0-312-137 0-273 0-410 0z m91 49c76 0 152 0 228 0-40 24-81 79-121 85-36-29-71-57-107-85z m270 28c0 62 0 124 0 186-104 0-208 0-312 0 0-62 0-124 0-186 52 42 104 83 156 125 52-42 104-83 156-125z', options: {
                    x: x, y: y, scale: 's0.04', attr: {
                        stroke: '#000',
                        strokeWidth: 0
                    }}},
                'CONDITIONAL': {path: 'm499 48c-1 0-2 0-3 0-202-1-391 150-436 346-42 173 28 368 174 471 145 107 354 116 506 18 149-93 235-276 207-450-26-176-164-330-338-371-36-9-73-14-110-14z m-5 49c3 0 7 0 10 0 187-2 362 146 392 331 32 167-54 348-205 427-154 85-363 54-483-77-124-127-147-338-53-488 71-116 203-192 339-193z m8 44c-3 0-7 0-10 0-172 0-330 143-349 314-22 161 79 328 233 382 145 55 322 3 413-124 98-129 92-326-17-447-67-77-167-125-270-125z m-2 48c2 0 4 0 6 0 153 0 292 129 304 281 16 145-84 293-225 330-137 40-296-27-361-154-69-129-33-305 86-392 54-42 122-65 190-65z m-151 121l0 12 0 368 50 0 202 0 50 0 0-380-302 0z m24 24l254 0 0 332-26 0-202 0-26 0 0-332z m26 37l0 25 202 0 0-25-202 0z m0 74l0 24 202 0 0-24-202 0z m0 85l0 24 202 0 0-24-202 0z m0 77l0 24 202 0 0-24-202 0z', options: {
                    x: x, y: y, scale: 's0.04', attr: {
                        stroke: '#000',
                        strokeWidth: 0
                    }}},
                'SIGNALTHROW': {path: 'm499 48c-220-4-425 177-448 396-24 185 78 380 247 461 160 80 368 56 501-66 134-118 190-318 128-486-57-167-217-293-393-303-12-1-23-2-35-2z m-5 49c202-7 391 161 407 362 19 178-92 361-262 420-166 61-368 2-468-145-103-144-99-356 18-490 74-90 188-146 305-147z m8 44c-186-6-358 158-361 344-9 169 116 334 283 367 155 33 328-46 397-190 71-140 39-327-83-430-64-57-150-91-236-91z m-2 48c164-4 314 144 311 308 3 152-119 297-272 312-143 19-295-73-336-213-43-134 14-295 138-364 48-28 103-43 159-43z m0 99c-64 115-128 230-192 345 128 0 256 0 384 0-64-115-128-230-192-345z', options: {x: x, y: y, scale: 's0.04', attr: {
                    stroke: '#000',
                    strokeWidth: 0
                }}}
            }
        };
        let rec = this.canvas.rect(this.x, this.y, this.scale, this.scale).attr({'fill': '#fff'})
        let border = this.svgLoader.loadElement(
            bases[type][marker].path,
            bases[type][marker].options
        );

        let group = this.canvas.group(rec, border);
        group.attr({
            id: this.options.id
        });
        this.shape.add(group);

        // this.shape.add(
        //     this.canvas.rect(this.x, this.y, this.scale, this.scale).attr({'fill': '#FFF', id: this.options.id})
        // );
        // this.shape.add(
        //     this.svgLoader.loadElement(
        //         bases[type][marker].path,
        //         bases[type][marker].options
        //     )
        // );
    }

    render(){
        this.getBase(
            this.options.type,
            this.options.eventDefinitions ? this.options.eventDefinitions[0].$type : this.options.marker
        );
        const textDecorator = this.getDecorator(
            'TEXT',
            {
                text: this.options.name,
                x: this.x,
                y: this.y
            }
        );
        this.shape.add(textDecorator);

        this.shape.drag();
    }


    getDecorator(type, options) {
        let decorator;
        switch (type) {
            case 'TEXT':
                decorator = this.canvas.multitext(options.x, options.y, options.text, 70, {});
                const tx = +(this.options.width - decorator.getBBox().width) / 2;
                const ty = +this.options.width;
                decorator.transform(`t ${tx}, ${ty}`);
                break;
            default:
                decorator = this.canvas.group();
                break;
        }
        return decorator;
    }

    getNativeShape() {
        return this.shape;
    }
    registerInputConn (id, conn) {
        this.inputConnectors.set(id, conn);
        this.setDirections(conn);
    }
    setDirections(conn) {
        conn.getShape().inputDirection = 'LEFT';
        conn.getShape().outputDirection = 'RIGHT';
    }
    registerOutputConn (id, conn) {
        this.outputConnectors.set(id, conn);
        this.setDirections(conn);
    }
    /**
     * Refresh all shapes connectors
     * @param posx
     * @param posy
     */
    refreshAllConnections(nativeShape){
        let conn, dX, dY;
        const shapeBox = nativeShape.getBBox();


        this.outputConnectors.forEach(function(value, key) {
            conn =  value;

            if (conn.shape.outputDirection === 'RIGHT'){
                dX= shapeBox.width;
                dY= shapeBox.height/2;
            }

            let linesArray = conn.shape.router;
            let n = linesArray.length;

            conn.shape.options.method = 'manhathan';
            conn.shape.config(conn.shape.options);

            conn.shape.redraw( shapeBox.x + dX ,  shapeBox.y + dY, linesArray[n-1].x, linesArray[n-1].y);
        });

        this.inputConnectors.forEach(function(value, key) {
            conn =  value;
            if (conn.shape.inputDirection === 'LEFT'){
                dX= 0;
                dY= shapeBox.height/2;
            }

            let linesArray = conn.shape.router;
            let n = linesArray.length;

            conn.shape.options.method = 'manhathan';
            conn.shape.config(conn.shape.options);

            conn.shape.redraw(linesArray[0].x, linesArray[0].y, shapeBox.x + dX ,  shapeBox.y + dY);

        })
    }
}
